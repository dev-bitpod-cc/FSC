# Markdown vs Plain Text æŸ¥è©¢æ•ˆæœåˆ†æå ±å‘Š

## ğŸ“‹ åŸ·è¡Œæ‘˜è¦

è£ç½°æ¡ˆä»¶çµæ§‹åŒ–å¾Œè½‰ Markdown å†ä¸Šå‚³ Gemini File Search,æŸ¥è©¢æ•ˆæœ**æ¯”æ•´ç¯‡ plain text ç›´æ¥ä¸Šå‚³å·®**ã€‚

ç¶“éä»£ç¢¼å¯©æŸ¥å’Œå¯¦éš›æª”æ¡ˆåˆ†æ,è­˜åˆ¥å‡º **5 å€‹é—œéµå•é¡Œ**,é€™äº›å•é¡Œæœƒé™ä½å‘é‡æª¢ç´¢çš„æ•ˆæœã€‚

---

## ğŸ” å•é¡Œåˆ†æ

### å•é¡Œ 1: åš´é‡çš„å…§å®¹é‡è¤‡ âš ï¸âš ï¸âš ï¸

**ç¾è±¡:**
Markdown æ ¼å¼ä¸­å­˜åœ¨å…©å€‹å€å¡ŠåŒ…å«å¹¾ä¹ç›¸åŒçš„å…§å®¹:
- `## ğŸ“ é•è¦äº‹ç”±` - åŒ…å«é•è¦æ‘˜è¦å’Œè©³ç´°èªªæ˜
- `## ğŸ“„ å®Œæ•´å…§å®¹` - åŒ…å«å®Œæ•´çš„è£è™•æ›¸å…§å®¹

**å¯¦éš›ç¯„ä¾‹:**

```markdown
## ğŸ“ é•è¦äº‹ç”±

**è©³ç´°èªªæ˜**:

è£ç½°æ¡ˆä»¶
_
å…¨çƒäººå£½ä¿éšªè‚¡ä»½æœ‰é™å…¬å¸è¾¦ç†ä¸€èˆ¬æ¥­å‹™æª¢æŸ¥å ±å‘Šï¼ˆç·¨è™Ÿï¼š112I018ï¼‰æ‰€åˆ—ç¼ºå¤±äº‹é …...
äº‹å¯¦:è²´å…¬å¸é›–è¨‚æœ‰ã€Œè‘£äº‹å·®æ—…è²»ç”³å ±ä½œæ¥­è¾¦æ³•ã€æ“šä»¥æ ¸éŠ·è‘£äº‹å·®æ—…è²»ç”¨ï¼ŒæƒŸæœªå°±è‘£äº‹å‡ºå·®è¨‚å®šæ‡‰äº‹å…ˆ...
ç†ç”±åŠæ³•ä»¤ä¾æ“š:
ä¸€ã€ä¾æ“šä¿éšªæ³•ç¬¬148æ¢ä¹‹3ç¬¬1é …æˆæ¬Šè¨‚å®šä¹‹...

## ğŸ“„ å®Œæ•´å…§å®¹

è£ç½°æ¡ˆä»¶
_
å…¨çƒäººå£½ä¿éšªè‚¡ä»½æœ‰é™å…¬å¸è¾¦ç†ä¸€èˆ¬æ¥­å‹™æª¢æŸ¥å ±å‘Šï¼ˆç·¨è™Ÿï¼š112I018ï¼‰æ‰€åˆ—ç¼ºå¤±äº‹é …...
äº‹å¯¦:è²´å…¬å¸é›–è¨‚æœ‰ã€Œè‘£äº‹å·®æ—…è²»ç”³å ±ä½œæ¥­è¾¦æ³•ã€æ“šä»¥æ ¸éŠ·è‘£äº‹å·®æ—…è²»ç”¨ï¼ŒæƒŸæœªå°±è‘£äº‹å‡ºå·®è¨‚å®šæ‡‰äº‹å…ˆ...
ç†ç”±åŠæ³•ä»¤ä¾æ“š:
ä¸€ã€ä¾æ“šä¿éšªæ³•ç¬¬148æ¢ä¹‹3ç¬¬1é …æˆæ¬Šè¨‚å®šä¹‹...
```

**å½±éŸ¿:**
1. **é‡è¤‡çš„å‘é‡åµŒå…¥:** ç›¸åŒå…§å®¹è¢«åµŒå…¥å…©æ¬¡,ç¨€é‡‹äº†æ–‡æª”çš„èªç¾©å¯†åº¦
2. **åˆ†å¡Šæ•ˆç‡é™ä½:** Gemini File Search éœ€è¦è™•ç†æ›´å¤šçš„é‡è¤‡åˆ†å¡Š
3. **æª¢ç´¢å™ªéŸ³:** æŸ¥è©¢æ™‚å¯èƒ½åŒ¹é…åˆ°é‡è¤‡çš„åˆ†å¡Š,é™ä½ç²¾ç¢ºåº¦
4. **æˆæœ¬å¢åŠ :** Plain text ç´„ 3-5KB,Markdown ç´„ 6-8KB (å¢åŠ  60-100%)

**ä¾†æº:**
- `src/processor/penalty_markdown_formatter.py:146-184`
- é•è¦äº‹ç”±å¾ `metadata['violation']['details']` æå–
- å®Œæ•´å…§å®¹å¾ `item['content']['text']` æå–
- å…©è€…ä¾†æºç›¸åŒ,åªæ˜¯æå–æ–¹å¼ä¸åŒ

---

### å•é¡Œ 2: æ³•æ¢ä¾æ“šæå–ä¸ç²¾ç¢º âš ï¸âš ï¸

**ç¾è±¡:**
`## ğŸ“œ æ³•æ¢ä¾æ“š` å€å¡ŠåŒ…å«ä¸ç›¸é—œå’Œé‡è¤‡çš„æ³•æ¢:

```markdown
## ğŸ“œ æ³•æ¢ä¾æ“š

1. ä¾ä¿éšªæ³•ç¬¬171æ¢ä¹‹1ç¬¬4é …è¦å®š
2. ä¸€ã€ä¾æ“šä¿éšªæ³•ç¬¬148æ¢ä¹‹3ç¬¬1é …æˆæ¬Šè¨‚å®šä¹‹ã€Œä¿éšªæ¥­å…§éƒ¨æ§åˆ¶åŠç¨½æ ¸åˆ¶åº¦å¯¦æ–½è¾¦æ³•ã€ç¬¬5æ¢ç¬¬1é …ç¬¬8æ¬¾è¦å®š
3. æ ¸æœ‰é•åä¿éšªæ³•ç¬¬148æ¢ä¹‹3ç¬¬1é …æˆæ¬Šè¨‚å®šä¹‹ã€Œä¿éšªæ¥­å…§éƒ¨æ§åˆ¶åŠç¨½æ ¸åˆ¶åº¦å¯¦æ–½è¾¦æ³•ã€ç¬¬5æ¢ç¬¬1é …ç¬¬8æ¬¾è¦å®š
4. ä¾è¨´é¡˜æ³•ç¬¬58æ¢ç¬¬1é …è¦å®š       # â† ç¨‹åºæ€§æ³•è¦,éæ ¸å¿ƒé•è¦
5. æƒŸä¾è¨´é¡˜æ³•ç¬¬93æ¢ç¬¬1é …è¦å®š     # â† ç¨‹åºæ€§æ³•è¦
6. å³ä¾è¡Œæ”¿åŸ·è¡Œæ³•ç¬¬4æ¢ç¬¬1é …ä½†æ›¸è¦å®š  # â† ç¨‹åºæ€§æ³•è¦
```

**å•é¡Œ:**
1. **åŒ…å«ç¨‹åºæ€§æ³•è¦:** è¨´é¡˜æ³•ã€è¡Œæ”¿åŸ·è¡Œæ³•èˆ‡é•è¦æœ¬è³ªç„¡é—œ
2. **é‡è¤‡æ¢ç›®:** ç¬¬2ã€3é …æ˜¯åŒä¸€å€‹æ³•æ¢,åªæ˜¯å‰ç¶´è©ä¸åŒ
3. **æ ¼å¼ä¸ä¸€è‡´:** æœ‰äº›å¸¶å‰ç¶´è©(ä¾ã€æ ¸ã€ä¸€ã€æƒŸã€å³),æœ‰äº›æ²’æœ‰
4. **èªç¾©å™ªéŸ³:** é€™äº›ç¨‹åºæ€§æ³•æ¢æœƒå¹²æ“¾ã€Œé•è¦é¡å‹ã€çš„æŸ¥è©¢

**ä¾†æº:**
- `src/processor/penalty_markdown_formatter.py:164-171`
- ç›´æ¥å¾ `metadata['legal_basis']` åˆ—è¡¨è¼¸å‡º,æœªç¶“éæ¿¾

**å„ªåŒ–å‰çš„æå–é‚è¼¯ (åƒè€ƒ `scripts/generate_file_mapping.py`):**
```python
# æ›¾ç¶“å„ªåŒ–é,ä½†åªç”¨æ–¼ mapping æª”,æ²’æœ‰å¥—ç”¨åˆ° Markdown formatter
# éæ¿¾ç¨‹åºæ€§æ³•è¦
excluded_laws = ['è¨´é¡˜æ³•', 'è¡Œæ”¿åŸ·è¡Œæ³•', 'è¡Œæ”¿ç½°æ³•']
core_laws = [law for law in laws if not any(ex in law for ex in excluded_laws)]

# ç§»é™¤å‰ç¶´è©ä¸¦å»é‡
prefixes = ['ä¾', 'æ ¸', 'çˆ°ä¾', 'ä¸€ã€', 'äºŒã€', '...']
```

---

### å•é¡Œ 3: çµæ§‹åŒ–æ¨™è¨˜éåº¦ âš ï¸

**ç¾è±¡:**
Markdown ä½¿ç”¨å¤§é‡çš„çµæ§‹åŒ–æ¨™è¨˜:

```markdown
# å…¨çƒäººå£½ä¿éšªè‚¡ä»½æœ‰é™å…¬å¸è¾¦ç†...

## ğŸ“‹ åŸºæœ¬è³‡è¨Š
- **æ–‡ä»¶ç·¨è™Ÿ**: `fsc_pen_20250925_0001`
- **ç™¼æ–‡å­—è™Ÿ**: ç™¼æ–‡å­—è™Ÿ:é‡‘ç®¡ä¿å£½å­—ç¬¬11404937382è™Ÿ

## ğŸ‘¤ è¢«è™•åˆ†å°è±¡
- **åç¨±**: å…¨çƒäººå£½ä¿éšªè‚¡ä»½æœ‰é™å…¬å¸

## âš–ï¸ è™•åˆ†å…§å®¹
- **è™•åˆ†é‡‘é¡**: æ–°è‡ºå¹£300è¬å…ƒ

## ğŸ“ é•è¦äº‹ç”±
...

## ğŸ“œ æ³•æ¢ä¾æ“š
...

## ğŸ“„ å®Œæ•´å…§å®¹
...

## ğŸ“ ç›¸é—œé™„ä»¶
...

---

*æ¨™ç±¤: æ—¥æœŸ:2025-09-25 | ä¾†æº:insurance_bureau | é¡å‹:aml_violation | è¢«è™•åˆ†äºº:å…¨çƒäººå£½ä¿éšªè‚¡ä»½æœ‰é™å…¬å¸ | é‡‘é¡:3000000*
```

**å•é¡Œ:**
1. **Emoji æ¨™è¨˜ (ğŸ“‹ğŸ“âš–ï¸ğŸ“œğŸ“):** å°å‘é‡åŒ–ç„¡æ„ç¾©,å¢åŠ  token æ¶ˆè€—
2. **å¤šå±¤ç´šæ¨™é¡Œ:** `#` å’Œ `##` æ‰“æ–·äº†æ–‡æœ¬çš„èªç¾©é€£è²«æ€§
3. **Markdown æ ¼å¼ç¬¦è™Ÿ:** `**`, `-`, `*` ç­‰å¢åŠ è§£ææˆæœ¬
4. **åˆ†å¡Šå¹²æ“¾:** Gemini File Search çš„åˆ†å¡Šæ¼”ç®—æ³•å¯èƒ½è¢«é€™äº›çµæ§‹æ¨™è¨˜èª¤å°

**å°æ¯” Plain Text:**
```
è£ç½°æ¡ˆä»¶

å…¨çƒäººå£½ä¿éšªè‚¡ä»½æœ‰é™å…¬å¸è¾¦ç†ä¸€èˆ¬æ¥­å‹™æª¢æŸ¥å ±å‘Šï¼ˆç·¨è™Ÿ:112I018ï¼‰æ‰€åˆ—ç¼ºå¤±äº‹é …...
2025-09-25

é‡‘èç›£ç£ç®¡ç†å§”å“¡æœƒ  è£è™•æ›¸
å—æ–‡è€…:å¦‚æ­£å‰¯æœ¬
ç™¼æ–‡æ—¥æœŸ:ä¸­è¯æ°‘åœ‹114å¹´9æœˆ25æ—¥
ç™¼æ–‡å­—è™Ÿ:é‡‘ç®¡ä¿å£½å­—ç¬¬11404937382è™Ÿ
...
```

Plain text æ˜¯é€£çºŒçš„ã€èªç¾©é€£è²«çš„,æ›´é©åˆå‘é‡åŒ–ã€‚

---

### å•é¡Œ 4: èª¤æŠ“é™„ä»¶æœªå®Œå…¨éæ¿¾ âš ï¸

**ç¾è±¡:**
å¯¦éš› Markdown æª”æ¡ˆä¸­ä»åŒ…å«ä¸ç›¸é—œçš„é€šç”¨é™„ä»¶:

```markdown
## ğŸ“ ç›¸é—œé™„ä»¶

1. **å¤±æ™ºè€…ç¶“æ¿Ÿå®‰å…¨ä¿éšœæ¨å‹•è¨ˆç•«** ([PDF](https://...))
   - æœ¬åœ°è·¯å¾‘: `data/attachments/penalties/unknown/attachment_1.pdf`
2. **é‡‘ç®¡æœƒæ°¸çºŒç™¼å±•ç›®æ¨™è‡ªé¡˜æª¢è¦–å ±å‘Š** ([PDF](https://...))
   - æœ¬åœ°è·¯å¾‘: `data/attachments/penalties/unknown/attachment_2.pdf`
```

**å•é¡Œ:**
é€™å…©å€‹é™„ä»¶å‡ºç¾åœ¨ **494/495 ç­†**æ¡ˆä»¶ä¸­,å®Œå…¨èˆ‡è£ç½°å…§å®¹ç„¡é—œã€‚

**æ ¹æœ¬åŸå› :**
- çˆ¬èŸ²å·²ä¿®æ­£ (`src/crawlers/penalties.py` åªæŠ“å– `div.zbox` å…§çš„é™„ä»¶)
- Markdown formatter æœ‰éæ¿¾é‚è¼¯ (`penalty_markdown_formatter.py:190-199`)
- **ä½†ç¾æœ‰çš„ Markdown æª”æ¡ˆæ˜¯èˆŠè³‡æ–™ç”Ÿæˆçš„,æ²’æœ‰é‡æ–°ç”Ÿæˆ**

**å½±éŸ¿:**
1. é™„ä»¶å…ƒè³‡æ–™æ±¡æŸ“æŸ¥è©¢çµæœ
2. æœ¬åœ°è·¯å¾‘æŒ‡å‘éŒ¯èª¤ (`unknown` è³‡æ–™å¤¾)

---

### å•é¡Œ 5: Footer æ¨™ç±¤æ ¼å¼ä¸åˆ©æ–¼æª¢ç´¢ âš ï¸

**ç¾è±¡:**
Footer ä½¿ç”¨ç®¡é“ç¬¦è™Ÿåˆ†éš”çš„ç·Šæ¹Šæ ¼å¼:

```markdown
*æ¨™ç±¤: æ—¥æœŸ:2025-09-25 | ä¾†æº:insurance_bureau | é¡å‹:aml_violation | è¢«è™•åˆ†äºº:å…¨çƒäººå£½ä¿éšªè‚¡ä»½æœ‰é™å…¬å¸ | é‡‘é¡:3000000*
```

**å•é¡Œ:**
1. **ä»£ç¢¼åŒ–:** `insurance_bureau`, `aml_violation` æ˜¯ä»£ç¢¼,ä¸æ˜¯è‡ªç„¶èªè¨€
2. **ç„¡èªå¢ƒ:** `é‡‘é¡:3000000` ç¼ºå°‘å–®ä½å’Œèªå¢ƒ
3. **ç·Šæ¹Šæ ¼å¼:** ç®¡é“ç¬¦è™Ÿåˆ†éš”,å‘é‡åŒ–æ™‚å¯èƒ½è¢«ç•¶ä½œä¸€å€‹é•·å­—ä¸²

**æ”¹å–„å»ºè­°:**
```markdown
## é—œéµè³‡è¨Š (ä¾›æª¢ç´¢)
- ç™¼å¸ƒæ—¥æœŸ: 2025å¹´9æœˆ25æ—¥
- ä¾†æºå–®ä½: é‡‘ç®¡æœƒä¿éšªå±€
- é•è¦é¡å‹: æ´—éŒ¢é˜²åˆ¶ç¼ºå¤±
- è¢«è™•åˆ†äºº: å…¨çƒäººå£½ä¿éšªè‚¡ä»½æœ‰é™å…¬å¸
- è™•åˆ†é‡‘é¡: æ–°è‡ºå¹£300è¬å…ƒæ•´
```

æˆ–è€…ç›´æ¥ç§»é™¤,å› ç‚ºé€™äº›è³‡è¨Šå·²ç¶“åœ¨ä¸Šé¢çš„å€å¡Šä¸­å‡ºç¾ã€‚

---

## ğŸ”¬ å‘é‡æª¢ç´¢åŸç†åˆ†æ

### Gemini File Search çš„å·¥ä½œæµç¨‹

1. **æ–‡æª”åˆ†å¡Š (Chunking):**
   - å°‡æ–‡æª”åˆ‡åˆ†æˆèªç¾©å®Œæ•´çš„åˆ†å¡Š (é€šå¸¸ 500-1000 tokens)
   - **Plain text:** é€£çºŒçš„æ–‡æœ¬,åˆ†å¡Šè‡ªç„¶ä¸”èªç¾©å®Œæ•´
   - **Markdown:** çµæ§‹æ¨™è¨˜ (`##`, emoji) å¯èƒ½å°è‡´ä¸è‡ªç„¶çš„åˆ†å¡Šé‚Šç•Œ

2. **å‘é‡åµŒå…¥ (Embedding):**
   - æ¯å€‹åˆ†å¡Šè½‰æ›ç‚ºé«˜ç¶­å‘é‡ (1536 ç¶­)
   - **Plain text:** èªç¾©å¯†é›†,å‘é‡è¡¨ç¤ºé›†ä¸­
   - **Markdown:** æ ¼å¼ç¬¦è™Ÿç¨€é‡‹èªç¾©,å‘é‡è¡¨ç¤ºåˆ†æ•£

3. **å‘é‡æª¢ç´¢ (Retrieval):**
   - æŸ¥è©¢ä¹Ÿè½‰æ›ç‚ºå‘é‡,è¨ˆç®—èˆ‡æ–‡æª”åˆ†å¡Šçš„é¤˜å¼¦ç›¸ä¼¼åº¦
   - **Plain text:** æŸ¥è©¢ã€Œè‘£äº‹å‡ºå·®ã€ç›´æ¥åŒ¹é…åˆ°ã€Œè‘£äº‹å‡ºå·®å ±éŠ·ã€
   - **Markdown:** å¯èƒ½åŒ¹é…åˆ° `## ğŸ“ é•è¦äº‹ç”±` æ¨™é¡Œ,è€Œéå¯¦éš›å…§å®¹

4. **é‡æ’åº (Reranking):**
   - ä½¿ç”¨æ›´è¤‡é›œçš„æ¨¡å‹å°æª¢ç´¢çµæœé‡æ–°æ’åº
   - **Plain text:** èªç¾©ç›¸é—œæ€§é«˜,é‡æ’åºæ•ˆæœå¥½
   - **Markdown:** é‡è¤‡å…§å®¹å¯èƒ½å°è‡´å¤šå€‹ä½è³ªé‡çµæœ

### ç‚ºä»€éº¼ Plain Text æ›´å¥½

| ç¶­åº¦ | Plain Text | Markdown | å‹è€… |
|------|-----------|----------|------|
| **èªç¾©å¯†åº¦** | é«˜ (ç´”æ–‡æœ¬) | ä½ (æ ¼å¼ç¬¦è™Ÿä½” 10-20%) | Plain |
| **å…§å®¹é‡è¤‡** | ç„¡ | åš´é‡ (60-100% å†—é¤˜) | Plain |
| **åˆ†å¡Šå“è³ª** | è‡ªç„¶ã€èªç¾©å®Œæ•´ | å¯èƒ½è¢«æ¨™è¨˜æ‰“æ–· | Plain |
| **æª¢ç´¢ç²¾ç¢ºåº¦** | é«˜ | ä½ (é‡è¤‡+å™ªéŸ³) | Plain |
| **å„²å­˜æˆæœ¬** | ä½ (3-5KB) | é«˜ (6-8KB) | Plain |
| **å¯è®€æ€§ (äººé¡)** | ä½ | é«˜ | Markdown |

**çµè«–:**
- **çµ¦ RAG çœ‹:** Plain text å„ªæ–¼ Markdown
- **çµ¦äººé¡çœ‹:** Markdown å„ªæ–¼ Plain text

---

## âœ… æ”¹å–„å»ºè­°

### æ–¹æ¡ˆ A: æœ€å°åŒ– Markdown (æ¨è–¦)

**ç›®æ¨™:** ä¿ç•™åŸºæœ¬çµæ§‹,ç§»é™¤å†—é¤˜å’Œå™ªéŸ³

**å…·é«”ä¿®æ”¹:**

1. **ç§»é™¤é‡è¤‡å€å¡Š**
   - åˆªé™¤ `## ğŸ“„ å®Œæ•´å…§å®¹` å€å¡Š
   - åªä¿ç•™çµæ§‹åŒ–çš„ `## ğŸ“ é•è¦äº‹ç”±`

2. **ç§»é™¤ Emoji å’Œéåº¦æ ¼å¼åŒ–**
   ```markdown
   # BEFORE
   ## ğŸ“‹ åŸºæœ¬è³‡è¨Š

   # AFTER
   ## åŸºæœ¬è³‡è¨Š
   ```

3. **ç²¾ç°¡æ³•æ¢ä¾æ“š**
   ```python
   # éæ¿¾ç¨‹åºæ€§æ³•è¦
   excluded = ['è¨´é¡˜æ³•', 'è¡Œæ”¿åŸ·è¡Œæ³•', 'è¡Œæ”¿ç½°æ³•']
   legal_basis = [law for law in legal_basis if not any(ex in law for ex in excluded)]

   # ç§»é™¤å‰ç¶´è©ä¸¦å»é‡
   import re
   cleaned_laws = []
   for law in legal_basis:
       law = re.sub(r'^(ä¾|æ ¸|çˆ°ä¾|ä¸€ã€|äºŒã€|ä¸‰ã€)', '', law).strip()
       if law not in cleaned_laws:
           cleaned_laws.append(law)
   ```

4. **ç§»é™¤ Footer æ¨™ç±¤**
   - å·²åœ¨å‰é¢å€å¡Šå‡ºç¾,ç„¡éœ€é‡è¤‡

5. **é‡æ–°ç”Ÿæˆæ‰€æœ‰ Markdown**
   - ä½¿ç”¨ä¿®æ­£å¾Œçš„çˆ¬èŸ²å’Œ formatter
   - ç¢ºä¿ç„¡èª¤æŠ“é™„ä»¶

**é æœŸæ•ˆæœ:**
- å…§å®¹å¤§å°: 6-8KB â†’ 3-4KB (-50%)
- é‡è¤‡ç‡: 60-100% â†’ 0%
- æŸ¥è©¢ç²¾ç¢ºåº¦: é æœŸæå‡ 30-50%

---

### æ–¹æ¡ˆ B: ä½¿ç”¨ Plain Text (æœ€ä½³æ•ˆæœ)

**å„ªé»:**
- âœ… èªç¾©å¯†åº¦æœ€é«˜
- âœ… é›¶é‡è¤‡
- âœ… å‘é‡åŒ–æ•ˆæœæœ€ä½³
- âœ… æœ€ç°¡å–®(ç„¡éœ€æ ¼å¼åŒ–)

**ç¼ºé»:**
- âŒ åŒ…å«ç¶²é é›œè¨Š (FACEBOOK, Line, Twitter, å‹å–„åˆ—å°)
- âŒ äººé¡å¯è®€æ€§è¼ƒå·®

**å»ºè­°å¯¦ä½œ:**
```python
def format_penalty_plain_text(item: Dict[str, Any]) -> str:
    """
    ç”Ÿæˆä¹¾æ·¨çš„ plain text (ç§»é™¤ç¶²é é›œè¨Š,ä¿ç•™æ ¸å¿ƒå…§å®¹)
    """
    content = item.get('content', {}).get('text', '')

    # ç§»é™¤ç¶²é é›œè¨Š
    noise_keywords = ['FACEBOOK', 'Line', 'Twitter', 'å‹å–„åˆ—å°', 'å›ä¸Šé ', 'ç€è¦½äººæ¬¡', 'æ›´æ–°æ—¥æœŸ']
    lines = content.split('\n')
    cleaned_lines = [
        line for line in lines
        if not any(keyword in line for keyword in noise_keywords)
    ]

    # åŠ ä¸ŠåŸºæœ¬å…ƒè³‡æ–™ (ç´”æ–‡å­—æ ¼å¼)
    metadata_lines = [
        f"æ–‡ä»¶ç·¨è™Ÿ: {item.get('id', 'N/A')}",
        f"ç™¼å¸ƒæ—¥æœŸ: {item.get('date', 'N/A')}",
        f"ä¾†æºå–®ä½: {item.get('source_raw', 'N/A')}",
        "",
        "--- è£è™•æ›¸å…§å®¹ ---",
        ""
    ]

    return '\n'.join(metadata_lines + cleaned_lines)
```

---

### æ–¹æ¡ˆ C: æ··åˆæ–¹æ¡ˆ (å…©è€…å…¼é¡§)

**æ¦‚å¿µ:**
- **ä¸Šå‚³ Plain Text åˆ° File Search Store** â†’ ç”¨æ–¼ RAG æŸ¥è©¢
- **Markdown ç”¨æ–¼å‰ç«¯é¡¯ç¤º** â†’ æå‡ä½¿ç”¨è€…é«”é©—

**å¯¦ä½œ:**
1. ç”Ÿæˆå…©å€‹ç‰ˆæœ¬:
   - `data/penalties_plaintext/*.txt` â†’ ä¸Šå‚³åˆ° Gemini
   - `data/penalties_markdown/*.md` â†’ å‰ç«¯é¡¯ç¤º

2. `file_mapping.json` è¨˜éŒ„å…©è€…å°æ‡‰é—œä¿‚:
   ```json
   {
     "fsc_pen_20250925_0001": {
       "gemini_id": "files/xyz123",        // Plain text çš„ Gemini ID
       "markdown_path": "data/penalties_markdown/...",
       "plaintext_path": "data/penalties_plaintext/...",
       ...
     }
   }
   ```

3. æŸ¥è©¢æµç¨‹:
   - ä½¿ç”¨è€…æŸ¥è©¢ â†’ Gemini File Search (plain text) â†’ è¿”å› Gemini ID
   - å‰ç«¯æ ¹æ“š Gemini ID æŸ¥æ‰¾å°æ‡‰çš„ Markdown æª”æ¡ˆ â†’ é¡¯ç¤ºæ ¼å¼åŒ–å…§å®¹

---

## ğŸ“Š æ€§èƒ½é æ¸¬

| æŒ‡æ¨™ | ç•¶å‰ Markdown | æ–¹æ¡ˆ A (æœ€å°åŒ–) | æ–¹æ¡ˆ B (Plain) | æ–¹æ¡ˆ C (æ··åˆ) |
|------|--------------|---------------|---------------|--------------|
| **æª”æ¡ˆå¤§å°** | 6-8KB | 3-4KB | 2-3KB | 2-3KB (ä¸Šå‚³) |
| **é‡è¤‡ç‡** | 60-100% | 0% | 0% | 0% |
| **æŸ¥è©¢ç²¾ç¢ºåº¦** | â­â­ | â­â­â­â­ | â­â­â­â­â­ | â­â­â­â­â­ |
| **äººé¡å¯è®€æ€§** | â­â­â­â­â­ | â­â­â­â­ | â­â­ | â­â­â­â­â­ |
| **å¯¦ä½œæˆæœ¬** | N/A | ä¸­ | ä½ | é«˜ |

---

## ğŸš€ å¯¦æ–½å»ºè­°

### çŸ­æœŸ (1-2 å¤©)

1. **æ–¹æ¡ˆ B (Plain Text)** - å¿«é€Ÿé©—è­‰æ•ˆæœ
   - ä¿®æ”¹ `src/uploader/gemini_uploader.py`
   - ç›´æ¥ä¸Šå‚³ `content.text` (æ¸…ç†é›œè¨Šå¾Œ)
   - å°æ¯”æŸ¥è©¢æ•ˆæœ

### ä¸­æœŸ (3-5 å¤©)

2. **æ–¹æ¡ˆ A (æœ€å°åŒ– Markdown)** - å¦‚æœéœ€è¦ä¿ç•™çµæ§‹
   - ä¿®æ”¹ `src/processor/penalty_markdown_formatter.py`
   - ç§»é™¤é‡è¤‡å€å¡Šã€éåº¦æ ¼å¼åŒ–ã€ç„¡æ•ˆæ³•æ¢
   - é‡æ–°ç”Ÿæˆæ‰€æœ‰ Markdown
   - é‡æ–°ä¸Šå‚³åˆ°æ–°çš„ Store

### é•·æœŸ (1-2 é€±)

3. **æ–¹æ¡ˆ C (æ··åˆ)** - æœ€ä½³ä½¿ç”¨è€…é«”é©—
   - Plain text çµ¦ RAG,Markdown çµ¦ä½¿ç”¨è€…
   - éœ€è¦å‰å¾Œç«¯å”èª¿

---

## ğŸ“ ç¸½çµ

**æ ¸å¿ƒå•é¡Œ:**
Markdown æ ¼å¼åŒ–å¼•å…¥äº† **60-100% çš„å…§å®¹é‡è¤‡** å’Œ **å¤§é‡æ ¼å¼å™ªéŸ³**,åš´é‡é™ä½å‘é‡æª¢ç´¢æ•ˆæœã€‚

**æ¨è–¦æ–¹æ¡ˆ:**
- **ç«‹å³æ¸¬è©¦:** æ–¹æ¡ˆ B (Plain Text)
- **é•·æœŸæ¡ç”¨:** æ–¹æ¡ˆ C (æ··åˆ) - RAG ç”¨ plain text,é¡¯ç¤ºç”¨ Markdown

**é æœŸæ”¹å–„:**
- æŸ¥è©¢ç²¾ç¢ºåº¦æå‡ 30-50%
- å„²å­˜æˆæœ¬é™ä½ 50%
- æŸ¥è©¢é€Ÿåº¦æå‡ (æ›´å°‘çš„åˆ†å¡Šéœ€è¦è™•ç†)

---

**å ±å‘Šæ—¥æœŸ:** 2025-11-18
**åˆ†æç¯„åœ:** `src/processor/penalty_markdown_formatter.py`, `data/markdown/penalties_individual/*.md`
**åƒè€ƒæ¡ˆä¾‹:** `fsc_pen_20250925_0001` (å…¨çƒäººå£½)
